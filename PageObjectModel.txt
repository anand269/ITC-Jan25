package RediffPages;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;

public class RediffHomePage {
	WebDriver driver;

	public RediffHomePage(WebDriver driver) //constructor
	{
		this.driver=driver;
	}

	By news = By.linkText("NEWS");
	By business = By.linkText("BUSINESS");
	
	public WebElement news() //method or function
	{
		//driver.findElement(By.xpath("//input[@name='login']"));
		return driver.findElement(news);
	}	

	public WebElement business() //method or function
	{
		//driver.findElement(By.xpath("//input[@name='login']"));
		return driver.findElement(business);
	}

}
-------
package RediffPages;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;

public class RediffLoginPage {
	
	WebDriver driver;
	
	public RediffLoginPage(WebDriver driver)
	{
		this.driver=driver; //meaning ?
	}
	
	By userName = By.xpath("//input[@id='login1']");
	By password = By.cssSelector("input[id='password']");	
	By signIn = By.name("proceed"); 
	By rediffHome = By.linkText("rediff.com");
	
	public WebElement password() //user defined menthods
	{
		return driver.findElement(password);
		
	}
	
	public WebElement signIn() //user defined menthods
	{
		return driver.findElement(signIn);
		
	}
	
	public WebElement userName() //user defined menthods
	{
		return driver.findElement(userName);
		
	}
	
	public WebElement rediffHome() //user defined menthods
	{
		return driver.findElement(rediffHome);
		
	}
	
	public void add(int a,int b) //user defined method for addition
	{
		double result=0;
		//return result; 
	}
}
-----------
package RediffTestCases;

import java.time.Duration;
import java.util.concurrent.TimeUnit;

import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

import RediffPages.RediffLoginPage;

public class RediffLoginTC1 {
	
	WebDriver driver=null;
	RediffLoginPage rlp;
	@BeforeTest
	public void invokeBrowser()
	{
		/*
		 * ChromeOptions co = new ChromeOptions(); co.setBrowserVersion("116");
		 */
		driver=new FirefoxDriver();
		driver.manage().window().maximize();
		driver.manage().timeouts().implicitlyWait(Duration.ofMillis(10));	
		driver.get("https://mail.rediff.com/cgi-bin/login.cgi");
	}
	
	@Test
	public void rediffLogin()
	{
		rlp = new RediffLoginPage(driver);//creating the instance of rlp
		rlp.userName().sendKeys("admin");
		rlp.password().sendKeys("admin123");
		rlp.signIn().click();
		rlp.rediffHome().click();
	}

}
------
package RediffTestCases;

import java.io.File;
import java.io.IOException;

import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.edge.EdgeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

import com.google.common.io.Files;

public class Base {
	static WebDriver driver=null;
	//@SuppressWarnings("deprecation")
		public static void invokeBrowser(String browser)//user defined method/function
		{
			if(browser.equalsIgnoreCase("chrome"))
			{
				driver = new ChromeDriver();
			}
			else if(browser.equals("firefox"))
			{
				driver = new FirefoxDriver();
			}
			else if(browser.equalsIgnoreCase("edge"))
			{
				driver = new EdgeDriver();
			}
			driver.manage().window().maximize();//max window size
			
		}
		
		public void closeBrowser() throws InterruptedException//close browser function
		{
			Thread.sleep(2000);
			driver.close();
		}
		
		public void takeScreenShot() throws IOException
		{
			File src=null;	
			src = ((TakesScreenshot)driver).getScreenshotAs(OutputType.FILE);
			Files.copy(src, new File("./scrshot/"+"screenshot-"+System.currentTimeMillis()+".png"));
		}

}

------
package RediffTestCases;

import java.io.FileInputStream;
import java.io.IOException;
import java.time.Duration;
import java.util.Properties;
import java.util.concurrent.TimeUnit;

import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.testng.annotations.AfterTest;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

import RediffPages.RediffHomePage;
import RediffPages.RediffLoginPage;

public class RediffLoginTC2 extends Base{

	//WebDriver driver;
	RediffLoginPage rlp;
	RediffHomePage rhp;
	FileInputStream fis1;
	Properties prop;
	
	  @BeforeTest public void invokeBrowser() throws IOException { driver=new
	  ChromeDriver(); //driver=new FirefoxDriver();
	  driver.manage().window().maximize();
	  driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20)); fis1 = new
	  FileInputStream("../GuruSchools12-Maven/data.properties"); prop = new
	  Properties(); prop.load(fis1); String url = prop.getProperty("url");
	  driver.get(url); }
	 

	@Test (enabled=false)
	public void rediffHome() throws InterruptedException, IOException
	{
		rlp = new RediffLoginPage(driver);//creating the instance of rlp
		//Property file usage


		rlp.userName().sendKeys(prop.getProperty("username"));
		rlp.password().sendKeys(prop.getProperty("password"));
		rlp.signIn().click();
		rlp.rediffHome().click();
		Thread.sleep(2000);
		rhp = new RediffHomePage(driver);
		rhp.news().click();
		takeScreenShot();

	}

	@Test (enabled=true)
	public void rediffExcel() throws InterruptedException, IOException
	{

		//Get the excel file
		FileInputStream excel = new FileInputStream("D:\\Automation\\AutomationData.xlsx");
		XSSFWorkbook workbook = new XSSFWorkbook(excel);
		XSSFSheet sheet = workbook.getSheet("Selenium");//workbook.getSheetAt(0);
		int rows = sheet.getPhysicalNumberOfRows();//Count the rows				
		int columns = sheet.getRow(1).getPhysicalNumberOfCells();//No of columns
		String cell1 = sheet.getRow(1).getCell(0).getStringCellValue();
		String cell2 = sheet.getRow(1).getCell(1).getStringCellValue();
		//System.out.println(cell);

		rlp = new RediffLoginPage(driver);//creating the instance of rlp
		rlp.userName().sendKeys(cell1);
		rlp.password().sendKeys(cell2);
		rlp.signIn().click();
		rlp.rediffHome().click();
		Thread.sleep(2000);
		rhp = new RediffHomePage(driver);
		rhp.news().click();
		takeScreenShot();

	}

	@Test (enabled=false)
	public void cell() throws IOException
	{
		//Get the excel file
		FileInputStream excel = new FileInputStream("D:\\Automation\\AutomationData.xlsx");
		XSSFWorkbook workbook = new XSSFWorkbook(excel);
		XSSFSheet sheet = workbook.getSheet("Selenium");//workbook.getSheetAt(0);
		int rows = sheet.getPhysicalNumberOfRows();//Count the rows				
		int columns = sheet.getRow(0).getPhysicalNumberOfCells();//No of columns
		String cell = sheet.getRow(1).getCell(0).getStringCellValue();
		System.out.println(cell);
	}

	
	  @AfterTest public void closeBrowser() throws InterruptedException {
	  Thread.sleep(3000); driver.close(); }
	 

}
-------